<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>A Deep Dive Into Terraform Static Code Analysis Tools: Features and Comparisons | devDosvid blog</title>
<meta name=keywords content="terraform,security,compliance,infrastructure-as-code,static-code-analysis"><meta name=description content="Explore key features and comparisons of top Terraform static code analysis tools to enhance security and compliance in your infrastructure management."><meta name=author content="Serhii Vasylenko"><link rel=canonical href=https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/><link crossorigin=anonymous href=/assets/css/stylesheet.30ced367583901b1986603cac38fcb00134d0f9279fb06fa37b9511cedf7a237.css integrity="sha256-MM7TZ1g5AbGYZgPKw4/LABNND5J5+wb6N7lRHO33ojc=" rel="preload stylesheet" as=style><link rel=icon href=https://devdosvid.blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://devdosvid.blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://devdosvid.blog/favicon-32x32.png><link rel=apple-touch-icon href=https://devdosvid.blog/apple-touch-icon.png><link rel=mask-icon href=https://devdosvid.blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><style>@font-face{font-family:albert sans;font-style:normal;font-display:swap;font-weight:300;src:url(/assets/fonts/AlbertSans-Light.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:albert sans;font-style:italic;font-display:swap;font-weight:300;src:url(/assets/fonts/AlbertSans-LightItalic.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:albert sans;font-style:normal;font-display:swap;font-weight:400;src:url(/assets/fonts/AlbertSans-Regular.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:albert sans;font-style:italic;font-display:swap;font-weight:400;src:url(/assets/fonts/AlbertSans-Italic.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:albert sans;font-style:normal;font-display:swap;font-weight:500;src:url(/assets/fonts/AlbertSans-Medium.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:albert sans;font-style:italic;font-display:swap;font-weight:500;src:url(/assets/fonts/AlbertSans-MediumItalic.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:albert sans;font-style:normal;font-display:swap;font-weight:600;src:url(/assets/fonts/AlbertSans-SemiBold.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:albert sans;font-style:italic;font-display:swap;font-weight:600;src:url(/assets/fonts/AlbertSans-SemiBoldItalic.woff2)format('woff');unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><meta name=twitter:creator content="@vasylenko"><meta name=twitter:site content="@vasylenko"><script async src=https://scripts.simpleanalyticscdn.com/latest.js></script><meta property="og:url" content="https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/"><meta property="og:site_name" content="devDosvid blog"><meta property="og:title" content="A Deep Dive Into Terraform Static Code Analysis Tools: Features and Comparisons"><meta property="og:description" content="Explore key features and comparisons of top Terraform static code analysis tools to enhance security and compliance in your infrastructure management."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-16T21:14:15+02:00"><meta property="article:modified_time" content="2025-04-04T21:07:26+02:00"><meta property="og:image" content="https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image.png"><meta property="og:see_also" content="https://devdosvid.blog/2023/04/16/hello-terraform-data-goodbye-null-resource/"><meta property="og:see_also" content="https://devdosvid.blog/2022/05/04/new-lifecycle-options-and-refactoring-capabilities-in-terraform-1-1-and-1-2/"><meta property="og:see_also" content="https://devdosvid.blog/2022/01/16/some-techniques-to-enhance-your-terraform-proficiency/"><meta property="og:see_also" content="https://devdosvid.blog/2021/11/24/guide-to-using-terraform-in-ci/cd/"><meta property="og:see_also" content="https://devdosvid.blog/2020/09/16/terraform-workflow-working-individually-and-in-a-team/"><meta property="og:see_also" content="https://devdosvid.blog/2020/09/15/terraform-certification-tips/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image.png"><meta name=twitter:title content="A Deep Dive Into Terraform Static Code Analysis Tools: Features and Comparisons"><meta name=twitter:description content="Explore key features and comparisons of top Terraform static code analysis tools to enhance security and compliance in your infrastructure management."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://devdosvid.blog/posts/"},{"@type":"ListItem","position":2,"name":"A Deep Dive Into Terraform Static Code Analysis Tools: Features and Comparisons","item":"https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A Deep Dive Into Terraform Static Code Analysis Tools: Features and Comparisons","name":"A Deep Dive Into Terraform Static Code Analysis Tools: Features and Comparisons","description":"Explore key features and comparisons of top Terraform static code analysis tools to enhance security and compliance in your infrastructure management.","keywords":["terraform","security","compliance","infrastructure-as-code","static-code-analysis"],"articleBody":"Many teams employ Terraform by HashiCorp to efficiently manage their infrastructure, leveraging its ability to automate the lifecycle of complex environments. Yet, integrating security scanning into Terraform pipelines often remains overlooked, exposing these environments to potential security risks and compliance issues.\nThis article explores several prominent static code analyzers that support Terraform code and focus on its security scanning. This comparison will guide teams in choosing the right tool to enhance their security measures within Terraform workflows, ensuring safer and more compliant infrastructure management.\nHere are the tools we‚Äôll be reviewing: KICS, tfsec, Trivy, Terrascan, Checkov, and Semgrep OSS.\nWhile many of these tools also support other platforms and technologies, this review will concentrate exclusively on their functionality with Terraform.\nWhy use Static Code Analysis for Terraform Static code analysis tools are necessary to enhance the security of Terraform-managed infrastructures. Unlike linters, these tools focus not on syntax errors or coding style but delve deeply into the code to identify security vulnerabilities and potential compliance issues without running the actual code. This proactive approach to security helps safeguard the infrastructure from potential threats before deployment.\nKey Benefits Early Detection: Identifies security vulnerabilities and misconfigurations early in development, preventing them from reaching production. Compliance Assurance: Ensures Terraform code complies with industry standards and internal security policies. Automated Security Integration: Seamlessly integrates with CI/CD pipelines, automating security checks to maintain a continuous focus on security. Actionable Insights: Delivers detailed vulnerability reports, facilitating swift and effective resolution. Scalability: Effectively handles increasing project complexity and size, maintaining rigorous security standards without additional manual effort. Expected Features Policy Coverage: The tool should offer comprehensive scanning capabilities to detect security vulnerabilities specific to Infrastructure as Code. Customizable Security Policies: It must allow users to define and adjust security policies and severity levels to align with specific project needs or compliance requirements. Seamless Integration: The analyzer should integrate effortlessly with existing CI/CD tools and version control systems, facilitating a smooth workflow. Detailed Reporting: Clear and actionable reports are crucial. The tool should prioritize issues based on severity and provide practical steps for remediation. Scanning Customization: Users should be able to tailor the scanning process to focus on particular aspects of the codebase, enabling targeted and efficient security assessments. With a clear understanding of the necessary features in a static code analyzer, which tools on the market best fulfill these criteria?\nLet‚Äôs take a closer look at some leading options!\nMeet the Static Code Analyzers for Terraform Following on what makes a static code analyzer robust, let‚Äôs dive into some open-source tools that exemplify these essential features.\nI picked six tools for my review. I know there are more on the market, but I focused on open-source, free-to-use tools and those that provide at least \u003e100 out-of-the-box scanning policies for Terraform.\nKICS (stands for ‚ÄúKeeping Infrastructure as Code Secure‚Äù): Owner/Maintainer: Checkmarx\nAge: First released on GitHub on November 30th, 2020\nLicense: Apache License 2.0\ntfsec\nOwner/Maintainer: Aqua Security (acquired in 2021)\nAge: First released on GitHub on March 5th, 2019\nLicense: MIT License tfsec project is no longer actively maintained in favor of the Trivy tool. But because many people still use it and it‚Äôs quite famous, I added tfsec to this comparison.\nHowever, I recommend against using it for new projects. Trivy\nOwner/Maintainer: Aqua Security\nAge: First released on GitHub on May 7th, 2019\nLicense: Apache License 2.0\nbackward-compatible with tfsec\nTerrascan\nOwner/Maintainer: Tenable (acquired in 2022)\nAge: First release on GitHub on November 28th, 2017\nLicense: Apache License 2.0\nCheckov\nOwner/Maintainer: Prisma Cloud by Palo Alto Networks (acquired in 2021)\nAge: First released on GitHub on March 31st, 2021\nLicense: Apache License 2.0\nSemgrep OSS\nOwner/Maintainer: Semgrep\nAge: First release on GitHub on February 6th, 2020\nLicense: GNU Lesser General Public License v2.1\nThese tools are essential in enhancing Terraform‚Äôs security posture and reflect a strong collaboration between open-source communities and enterprise backing. This blend ensures that the tools are not only accessible but also robustly maintained and up-to-date.\nLet‚Äôs explore how these tools stack up regarding features and usability.\nComparing Out-of-the-Box Policies and Terraform Providers Understanding the number and variety of default policies each tool offers is crucial for those just beginning to explore security automation for Terraform.\nThe extent of out-of-the-box policies can significantly ease the integration process of static analysis by providing immediate and comprehensive insights into potential security and compliance issues. Similarly, the number of supported Terraform Providers also plays a critical role.\nIn this chapter, we delve into these foundational features across observed tools, helping you pinpoint which one could best satisfy your requirements for robust, ready-to-use security scanning.\nTool Policies Supported Terraform Providers KICS 663 aws, azure, gcp, kubernetes, alicloud, databricks, github, nifcloud tfsec 154 aws, azure, gcp, digitalocean, kubernetes, cloudstack, github, openstack, oracle Trivy 322 aws, azure, gcp, digitalocean, cloudstack, github, oracle, openstack Terrascan 790 aws, azure, gcp, digitalocean, kubernetes, docker, github Checkov 2110 aws, azure, gcp, digitalocean, kubernetes, github, gitlab, ibm, linode, openstack, alicloud Semgrep OSS 362 aws, azure, gcp As you can see, all tools support the ‚ÄúBig Three‚Äù cloud service Terraform providers‚ÄîAWS, Azure, and GCP‚Äîfor managing resources on these popular platforms.\nWith over 2000 out-of-the-box policies, Checkov significantly stands out from the competition. This tool also leads in the total number of supported Terraform providers.\nWhile the default policies provide a strong foundation for security scanning, the ability to tailor these policies is just as crucial. Next, we‚Äôll explore how each tool accommodates custom policy capabilities, allowing you to fine-tune the policies to fit your project‚Äôs specific requirements.\nCustom Policy Capabilities Default policies serve as the foundation, but the nuances of each project demand the extension of this base.\nHere, we delve into how each tool enables you to add custom policies, thus enhancing and refining the provided defaults.\nWhile all six tools support adding custom policies to their default set, they differ in terminology: ‚Äòpolicy‚Äô is the common term, whereas KICS refers to them as ‚Äòqueries,‚Äô and Semgrep calls them ‚Äòrules.‚Äô\nRegarding policy syntax:\nOPA Rego syntax is used by KICS, Trivy, tfsec, and Terrascan. It‚Äôs a powerful language widely adopted in the industry, though there‚Äôs a learning curve that could pay dividends for future projects.\nYAML syntax is used by Checkov and Semgrep. This offers a familiar and straightforward start, with Checkov also allowing policies to be written in Python, albeit with some constraints. With YAML, the ease of use is balanced against the limitations set by the tool‚Äôs capabilities.\nUnderstanding these differences will guide you to a tool that matches your security requirements, your team‚Äôs expertise, and the scope of your infrastructure projects.\nTo illustrate, here is an example of a KICS Rego policy checking for default RDS instance ports:\npackage Cx import data.generic.common as common_lib import data.generic.terraform as tf_lib CxPolicy[result] { db := input.document[i].resource.aws_db_instance[name] enginePort := common_lib.engines[e] db.engine == e db.port == enginePort result := { \"documentId\": input.document[i].id, \"resourceType\": \"aws_db_instance\", \"resourceName\": tf_lib.get_resource_name(db, name), \"searchKey\": sprintf(\"aws_db_instance[%s].port\", [name]), \"issueType\": \"IncorrectValue\", \"keyExpectedValue\": sprintf(\"aws_db_instance[%s].port should not be set to %d\", [name, enginePort]), \"keyActualValue\": sprintf(\"aws_db_instance[%s].port is set to %d\", [name, enginePort]), \"searchLine\": common_lib.build_search_line([\"resource\", \"aws_db_instance\", name, \"port\"], []), } } And an example of a Checkov YAML policy forbidding specific EC2 instance types:\n--- metadata: name: \"Org's compute instances should not be p5.48xlarge or p4d.24xlarge\" id: \"ACME_AWS_FORBIDDEN_EC2_TYPES\" category: \"NETWORKING\" definition: or: - cond_type: \"attribute\" resource_types: - \"aws_instance\" attribute: \"instance_type\" operator: \"not_equals\" value: \"p5.48xlarge\" - cond_type: \"attribute\" resource_types: - \"aws_instance\" attribute: \"instance_type\" operator: \"not_equals\" value: \"p4d.24xlarge\" With the ability to tailor policies to our specific needs, we‚Äôll next explore each tool‚Äôs capacity to integrate broadly, determining how well they play with the rest of our tech stack.\nIntegration Capabilities Integration capabilities are the cornerstone of efficient DevOps practices.\nThis section will evaluate how each static code analyzer enhances your tech stack through seamless integration with other systems and technologies.\nWe will assess each tool against four key integration points that are vital for development workflows:\nDocker Image: Ensures easy deployment across any container-supported environment. IDE Plugins: Facilitates real-time feedback and improves code quality directly within the developer‚Äôs workspace. CI/CD Systems: Supports direct integration through plugins or extensions, eliminating the need for manual downloads or CLI setups. Pre-commit Hook: Provides an early security checkpoint by scanning code before it is committed, catching errors at the initial stages. Tool Docker Image IDE Plugins CI/CD Systems Hook KICS ‚úÖ VSCode Github Actions, GitLab, Terraform Cloud, Codefresh ‚úÖ tfsec ‚úÖ VSCode, JetBrains, Vim Github Actions ‚ùå Trivy ‚úÖ VSCode, JetBrains, Vim Azure DevOps, GitHub Actions, Buildkite, Dagger, Semaphore, CircleCI, Concourse CI ‚ùå Terrascan ‚úÖ VSCode GitHub Actions, Atlantis ‚úÖ Checkov ‚úÖ VSCode, JetBrains GitHub Actions, GitLab ‚úÖ Semgrep OSS ‚úÖ VSCode, JetBrains, Emacs, Vim GitLab ‚úÖ In addition to the table above, here are a few noteworthy features of some tools:\nCheckov supports OpenAI integration to suggest remediations. But be careful because AI tends to hallucinate. KICS supports applying auto-remediation for some of its out-of-the-box policies. This also applies to custom policies, where you can define remediations and apply them automatically. Terrascan is the only one that provides the VSCode extension to create and test custom policies written in Rego. GitLab uses KICS as its default built-in IaC scanner ‚Äî available out of the box with ‚ÄúInfrastructure as Code scanning‚Äù. However, there‚Äôs also GitLab CI Component available for Checkov. Having covered the integration capabilities, let‚Äôs now focus on the output formats each tool provides.\nOutput Formats Provided Output formats extend the utility of static code analysis, facilitating integration with the CI/CD feedback loop and enabling its use as an artifact in subsequent CI jobs.\nThis chapter examines the variety of formats each tool supports for this purpose.\nEach tool offers a range of output formats tailored to different needs.\nFor GitLab users: For teams leveraging GitLab‚Äôs security scanning, KICS, Checkov, and Semgrep OSS are equipped with compatible output formats, facilitating smooth GitLab integration.\nFor GitHub users: SARIF‚Äôs adoption as an industry standard, particularly by GitHub for code scanning, makes it a must-have. All tools assessed offer SARIF support, ensuring interoperability and broad utility.\nJUnit Reports: The availability of JUnit output is crucial for capturing test results in a format recognizable by various CI systems. Trivy, Terrascan, Checkov, and Semgrep OSS support this, enabling clear visualization of test outcomes and enhancing the feedback loop within CI pipelines.\nBeyond these, each tool supports additional formats, enriching their application and versatility. Here‚Äôs the full breakdown of the output formats, complementing the standard CLI output:\nTool Supported Output Formats KICS ASFF, CSV, Code Climate, CycloneDX, GItLab SAST, HTML, JSON, JUnit, PDF, SARIF, SonarQube tfsec Checkstyle, CSV, HTML, JSON, JUnit, Markdown, SARIF Trivy ASFF, Cosign, CycloneDX, JSON, SARIF, SPDX Terrascan JSON, JUnit, SARIF, XML, YAML Checkov CSV, CycloneDX, GItLab SAST, JSON, JUnit, SARIF, SPDX Semgrep OSS Emacs, GitLab SAST, JSON, JUnit, SARIF, Vim Moving from output formats to operational adaptability, let‚Äôs investigate the customization options for scanner settings. This important feature allows each tool to align with varied project demands.\nCustomizing Scanner Settings This chapter moves beyond the default scanner settings and delves into scanner settings‚Äô customizability, ensuring that tools can be calibrated for any development environment or security requirement.\nI will evaluate each tool against criteria that define a tool‚Äôs adaptability and user-friendliness:\nTargeted Scans: Select specific directories for scanning or exclusion to focus on pertinent areas and skip irrelevant ones. In-Code Ignore Policies: Enable ignore directives within code to skip checks when exceptions apply selectively. Severity Thresholds: Set reporting to include only findings above a chosen severity level, concentrating on the most impactful issues. Configuration File: Employ configuration files for consistency and collaboration, enabling a ‚Äòconfiguration as code‚Äô approach. TF Variables Interpolation: Interpret and evaluate Terraform variables for an accurate security assessment of IaC. Module Scanning: For complete coverage, scans should include both local and remote (public/private) Terraform modules. Based on these criteria, the following table offers a comparative view of how each tool performs, giving you a clear snapshot of their customization capabilities:\nTool Targeted Scans Ignore Policies Min Severity Config File Variables Interpolation Module Scanning KICS ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚ÅâÔ∏èÔ∏è tfsec ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ Trivy ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ Terrascan ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ Checkov ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ ‚úÖ Semgrep OSS ‚úÖ ‚úÖ ‚úÖ ‚ùå ‚úÖ ‚ùå Most reviewed tools meet nearly all the criteria set for scanner setting customization, demonstrating their flexibility and advanced capabilities. However, there are notable features worth considering:\nKICS: Provides limited module scanning capabilities, restricted to some public modules from the Terraform registry, and does not cover local or private custom modules. Terrascan \u0026 Trivy: Both feature server modes that centralize vulnerability databases. This centralization facilitates a unified approach to applying policies and configurations, enhancing consistency and efficiency for teams and reducing the management overhead of diverse policies across multiple projects. Semgrep: It doesn‚Äôt support scanner configuration files; instead, it uses the ‚Äúconfig‚Äù word to call the rule sets and accepts such configs. Notably, it also does not support the scanning of Terraform modules at all. Terraform Security Scanning: The Big Picture and Top Pick Here‚Äôs a comprehensive comparison summary to guide your selection of the most suitable Terraform static code analyzer:\nTool Default Policies Custom Policies Integration Output Formats Customization KICS 663 OPA Rego ‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook ASFF, CSV, Code Climate, CycloneDX, GItLab SAST, HTML, JSON, JUnit, PDF, SARIF, SonarQube ‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚ùåModule Scanning tfsec 154 OPA Rego ‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚ùåGit Hook Checkstyle, CSV, HTML, JSON, JUnit, Markdown, SARIF ‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning Trivy 322 OPA Rego ‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚ùåGit Hook ASFF, Cosign, CycloneDX, JSON, SARIF, SPDX ‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning Terrascan 790 OPA Rego ‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook JSON, JUnit, SARIF, XML, YAML ‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning Checkov 2110 YAML, Python ‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook CSV, CycloneDX, GItLab SAST, JSON, JUnit, SARIF, SPDX ‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning Semgrep OSS 362 YAML ‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook Emacs, GitLab SAST, JSON, JUnit, SARIF, Vim ‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚ùåConfig File, ‚úÖVariables Interpolation, ‚ùåModule Scanning Integrating a Terraform security scanning into your development pipeline is a proven strategy to boost your security posture. These tools detect potential vulnerabilities early and enforce best practices and compliance standards, representing a proactive approach to infrastructure security.\nFor teams not yet utilizing these tools, Checkov is my top recommendation:\nBiggest number of default policies and supported Terraform providers for a quick start. Custom policy support in YAML and Python for flexible policy creation. Wide integration options with Docker, IDEs, CI/CD systems, and Git Hooks for a smooth workflow. Please share your favorite tool in the comments below! Also, let me know if I missed a cool product that should have been included in the review.\n","wordCount":"2491","inLanguage":"en","image":"https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image.png","datePublished":"2024-04-16T21:14:15+02:00","dateModified":"2025-04-04T21:07:26+02:00","author":{"@type":"Person","name":"Serhii Vasylenko"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/"},"publisher":{"@type":"Person","name":"devDosvid blog","logo":{"@type":"ImageObject","url":"https://devdosvid.blog/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://devdosvid.blog/ accesskey=h title="üè† Home (Alt + H)">üè† Home</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://devdosvid.blog/index.xml title="RSS Feed"><span>RSS Feed</span></a></li><li><a href=https://devdosvid.blog/archive title="All posts"><span>All posts</span></a></li><li><a href=https://devdosvid.blog/about/ title="About me"><span>About me</span></a></li><li><a href=https://devdosvid.blog/series title="Post Series"><span>Post Series</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://devdosvid.blog/>Home</a>&nbsp;¬ª&nbsp;<a href=https://devdosvid.blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">A Deep Dive Into Terraform Static Code Analysis Tools: Features and Comparisons</h1><div class=post-description>Explore key features and comparisons of top Terraform static code analysis tools to enhance security and compliance in your infrastructure management.</div><div class=post-meta><span title='2024-04-16 21:14:15 +0200 +0200'>April 16, 2024</span>&nbsp;¬∑&nbsp;Serhii Vasylenko&nbsp;|&nbsp;<a href=mailto:contact@devdosvid.blog rel="noopener noreferrer" target=_blank>Contact me</a></div></header><figure class=entry-cover><img srcset="https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image_hu_a2cd008eda8d5225.png 360w ,https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image_hu_5502ab0198c8aa62.png 480w ,https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image_hu_7ebb8ea1614eb954.png 720w ,https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image_hu_85c44a8b6b05e019.png 1080w ,https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image.png 1200w" sizes="(min-width: 768px) 720px, 100vw" src=https://devdosvid.blog/2024/04/16/a-deep-dive-into-terraform-static-code-analysis-tools-features-and-comparisons/cover-image.png alt="Terraform Static Code Analysis Tools" width=1200 height=630></figure><div class=post-content><p>Many teams employ Terraform by HashiCorp to efficiently manage their infrastructure, leveraging its ability to automate the lifecycle of complex environments. Yet, integrating security scanning into Terraform pipelines often remains overlooked, exposing these environments to potential security risks and compliance issues.</p><p>This article explores several prominent static code analyzers that support Terraform code and focus on its security scanning. This comparison will guide teams in choosing the right tool to enhance their security measures within Terraform workflows, ensuring safer and more compliant infrastructure management.</p><p>Here are the tools we&rsquo;ll be reviewing: <strong>KICS</strong>, <strong>tfsec</strong>, <strong>Trivy</strong>, <strong>Terrascan</strong>, <strong>Checkov</strong>, and <strong>Semgrep OSS</strong>.</p><p>While many of these tools also support other platforms and technologies, <strong>this review will concentrate exclusively on their functionality with Terraform.</strong></p><h2 id=why-use-static-code-analysis-for-terraform>Why use Static Code Analysis for Terraform<a hidden class=anchor aria-hidden=true href=#why-use-static-code-analysis-for-terraform>#</a></h2><p>Static code analysis tools are necessary to enhance the security of Terraform-managed infrastructures. Unlike linters, these tools focus not on syntax errors or coding style but delve deeply into the code to identify security vulnerabilities and potential compliance issues without running the actual code. This proactive approach to security helps safeguard the infrastructure from potential threats before deployment.</p><h3 id=key-benefits>Key Benefits<a hidden class=anchor aria-hidden=true href=#key-benefits>#</a></h3><ul><li>Early Detection: Identifies security vulnerabilities and misconfigurations early in development, preventing them from reaching production.</li><li>Compliance Assurance: Ensures Terraform code complies with industry standards and internal security policies.</li><li>Automated Security Integration: Seamlessly integrates with CI/CD pipelines, automating security checks to maintain a continuous focus on security.</li><li>Actionable Insights: Delivers detailed vulnerability reports, facilitating swift and effective resolution.</li><li>Scalability: Effectively handles increasing project complexity and size, maintaining rigorous security standards without additional manual effort.</li></ul><h3 id=expected-features>Expected Features<a hidden class=anchor aria-hidden=true href=#expected-features>#</a></h3><ul><li><strong>Policy Coverage</strong>: The tool should offer comprehensive scanning capabilities to detect security vulnerabilities specific to Infrastructure as Code.</li><li><strong>Customizable Security Policies</strong>: It must allow users to define and adjust security policies and severity levels to align with specific project needs or compliance requirements.</li><li><strong>Seamless Integration</strong>: The analyzer should integrate effortlessly with existing CI/CD tools and version control systems, facilitating a smooth workflow.</li><li><strong>Detailed Reporting</strong>: Clear and actionable reports are crucial. The tool should prioritize issues based on severity and provide practical steps for remediation.</li><li><strong>Scanning Customization</strong>: Users should be able to tailor the scanning process to focus on particular aspects of the codebase, enabling targeted and efficient security assessments.</li></ul><p>With a clear understanding of the necessary features in a static code analyzer, which tools on the market best fulfill these criteria?</p><p>Let&rsquo;s take a closer look at some leading options!</p><h2 id=meet-the-static-code-analyzers-for-terraform>Meet the Static Code Analyzers for Terraform<a hidden class=anchor aria-hidden=true href=#meet-the-static-code-analyzers-for-terraform>#</a></h2><p>Following on what makes a static code analyzer robust, let&rsquo;s dive into some open-source tools that exemplify these essential features.</p><p>I picked six tools for my review. I know there are more on the market, but I focused on <strong>open-source, free-to-use</strong> tools and those that provide at least >100 out-of-the-box scanning policies for Terraform.</p><p><strong>KICS</strong> (stands for &ldquo;Keeping Infrastructure as Code Secure&rdquo;):<br>Owner/Maintainer: Checkmarx<br>Age: First released on GitHub on November 30th, 2020<br>License: <a href=https://github.com/Checkmarx/kics/blob/master/LICENSE>Apache License 2.0</a></p><p><strong>tfsec</strong><br>Owner/Maintainer: Aqua Security (acquired in 2021)<br>Age: First released on GitHub on March 5th, 2019<br>License: <a href=https://github.com/aquasecurity/tfsec/blob/master/LICENSE>MIT License</a><div class=attention>tfsec project is no longer actively maintained in favor of the Trivy tool. But because many people still use it and it&rsquo;s quite famous, I added tfsec to this comparison.<br>However, I recommend against using it for new projects.</div></p><p><strong>Trivy</strong><br>Owner/Maintainer: Aqua Security<br>Age: First released on GitHub on May 7th, 2019<br>License: <a href=https://github.com/aquasecurity/trivy/blob/main/LICENSE>Apache License 2.0</a><br><em>backward-compatible with tfsec</em></p><p><strong>Terrascan</strong><br>Owner/Maintainer: Tenable (acquired in 2022)<br>Age: First release on GitHub on November 28th, 2017<br>License: <a href=https://github.com/tenable/terrascan/blob/master/LICENSE>Apache License 2.0</a></p><p><strong>Checkov</strong><br>Owner/Maintainer: Prisma Cloud by Palo Alto Networks (acquired in 2021)<br>Age: First released on GitHub on March 31st, 2021<br>License: <a href=https://github.com/bridgecrewio/checkov/blob/main/LICENSE>Apache License 2.0</a></p><p><strong>Semgrep OSS</strong><br>Owner/Maintainer: Semgrep<br>Age: First release on GitHub on February 6th, 2020<br>License: <a href=https://github.com/semgrep/semgrep/blob/develop/LICENSE>GNU Lesser General Public License v2.1</a></p><p>These tools are essential in enhancing Terraform&rsquo;s security posture and reflect a strong collaboration between open-source communities and enterprise backing. This blend ensures that the tools are not only accessible but also robustly maintained and up-to-date.</p><p>Let‚Äôs explore how these tools stack up regarding features and usability.</p><h2 id=comparing-out-of-the-box-policies-and-terraform-providers>Comparing Out-of-the-Box Policies and Terraform Providers<a hidden class=anchor aria-hidden=true href=#comparing-out-of-the-box-policies-and-terraform-providers>#</a></h2><p>Understanding the number and variety of default policies each tool offers is crucial for those just beginning to explore security automation for Terraform.</p><p>The extent of out-of-the-box policies can significantly ease the integration process of static analysis by providing immediate and comprehensive insights into potential security and compliance issues. Similarly, the number of supported Terraform Providers also plays a critical role.</p><p>In this chapter, we delve into these foundational features across observed tools, helping you pinpoint which one could best satisfy your requirements for robust, ready-to-use security scanning.</p><table><thead><tr><th>Tool</th><th>Policies</th><th>Supported Terraform Providers</th></tr></thead><tbody><tr><td><strong>KICS</strong></td><td>663</td><td>aws, azure, gcp, kubernetes, alicloud, databricks, github, nifcloud</td></tr><tr><td><strong>tfsec</strong></td><td>154</td><td>aws, azure, gcp, digitalocean, kubernetes, cloudstack, github, openstack, oracle</td></tr><tr><td><strong>Trivy</strong></td><td>322</td><td>aws, azure, gcp, digitalocean, cloudstack, github, oracle, openstack</td></tr><tr><td><strong>Terrascan</strong></td><td>790</td><td>aws, azure, gcp, digitalocean, kubernetes, docker, github</td></tr><tr><td><strong>Checkov</strong></td><td>2110</td><td>aws, azure, gcp, digitalocean, kubernetes, github, gitlab, ibm, linode, openstack, alicloud</td></tr><tr><td><strong>Semgrep OSS</strong></td><td>362</td><td>aws, azure, gcp</td></tr></tbody></table><p>As you can see, all tools support the &ldquo;Big Three&rdquo; cloud service Terraform providers‚ÄîAWS, Azure, and GCP‚Äîfor managing resources on these popular platforms.</p><p>With over 2000 out-of-the-box policies, Checkov significantly stands out from the competition. This tool also leads in the total number of supported Terraform providers.</p><p>While the default policies provide a strong foundation for security scanning, the ability to tailor these policies is just as crucial. Next, we&rsquo;ll explore how each tool accommodates custom policy capabilities, allowing you to fine-tune the policies to fit your project&rsquo;s specific requirements.</p><h2 id=custom-policy-capabilities>Custom Policy Capabilities<a hidden class=anchor aria-hidden=true href=#custom-policy-capabilities>#</a></h2><p>Default policies serve as the foundation, but the nuances of each project demand the extension of this base.</p><p>Here, we delve into how each tool enables you to add custom policies, thus enhancing and refining the provided defaults.</p><p>While all six tools support adding custom policies to their default set, they differ in terminology: &lsquo;policy&rsquo; is the common term, whereas KICS refers to them as &lsquo;queries,&rsquo; and Semgrep calls them &lsquo;rules.&rsquo;</p><p>Regarding policy syntax:</p><p><strong>OPA Rego</strong> syntax is used by <a href=https://docs.kics.io/latest/creating-queries/>KICS</a>, <a href=https://aquasecurity.github.io/trivy/v0.50/docs/scanner/misconfiguration/custom/>Trivy</a>, <a href=https://aquasecurity.github.io/tfsec/latest/guides/rego/rego/>tfsec</a>, and <a href=https://runterrascan.io/docs/policies/policies/>Terrascan</a>. It&rsquo;s a powerful language widely adopted in the industry, though there&rsquo;s a learning curve that could pay dividends for future projects.</p><p><strong>YAML</strong> syntax is used by <a href=https://www.checkov.io/3.Custom%20Policies/Custom%20Policies%20Overview.html>Checkov</a> and <a href=https://semgrep.dev/docs/writing-rules/rule-syntax/>Semgrep</a>. This offers a familiar and straightforward start, with Checkov also allowing policies to be written in Python, albeit with some constraints. With YAML, the ease of use is balanced against the limitations set by the tool&rsquo;s capabilities.</p><p>Understanding these differences will guide you to a tool that matches your security requirements, your team&rsquo;s expertise, and the scope of your infrastructure projects.</p><p>To illustrate, here is an example of a KICS Rego policy checking for default RDS instance ports:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>package Cx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>import data.generic.common as common_lib
</span></span><span style=display:flex><span>import data.generic.terraform as tf_lib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CxPolicy[result] {
</span></span><span style=display:flex><span>	db := input.document[i].resource.aws_db_instance[name]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	enginePort := common_lib.engines[e]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	db.engine == e
</span></span><span style=display:flex><span>	db.port == enginePort
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	result := {
</span></span><span style=display:flex><span>		&#34;documentId&#34;: input.document[i].id,
</span></span><span style=display:flex><span>		&#34;resourceType&#34;: &#34;aws_db_instance&#34;,
</span></span><span style=display:flex><span>		&#34;resourceName&#34;: tf_lib.get_resource_name(db, name),
</span></span><span style=display:flex><span>		&#34;searchKey&#34;: sprintf(&#34;aws_db_instance[%s].port&#34;, [name]),
</span></span><span style=display:flex><span>		&#34;issueType&#34;: &#34;IncorrectValue&#34;,
</span></span><span style=display:flex><span>		&#34;keyExpectedValue&#34;: sprintf(&#34;aws_db_instance[%s].port should not be set to %d&#34;, [name, enginePort]),
</span></span><span style=display:flex><span>		&#34;keyActualValue&#34;: sprintf(&#34;aws_db_instance[%s].port is set to %d&#34;, [name, enginePort]),
</span></span><span style=display:flex><span>		&#34;searchLine&#34;: common_lib.build_search_line([&#34;resource&#34;, &#34;aws_db_instance&#34;, name, &#34;port&#34;], []),
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And an example of a Checkov YAML policy forbidding specific EC2 instance types:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ff7b72>---</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>metadata</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681> </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Org&#39;s compute instances should not be p5.48xlarge or p4d.24xlarge&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681> </span><span style=color:#7ee787>id</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;ACME_AWS_FORBIDDEN_EC2_TYPES&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681> </span><span style=color:#7ee787>category</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;NETWORKING&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>definition</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681> </span><span style=color:#7ee787>or</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681> </span>- <span style=color:#7ee787>cond_type</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;attribute&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>resource_types</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#a5d6ff>&#34;aws_instance&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>attribute</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;instance_type&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>operator</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;not_equals&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>value</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;p5.48xlarge&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681> </span>- <span style=color:#7ee787>cond_type</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;attribute&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>resource_types</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span>- <span style=color:#a5d6ff>&#34;aws_instance&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>attribute</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;instance_type&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>operator</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;not_equals&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>   </span><span style=color:#7ee787>value</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;p4d.24xlarge&#34;</span><span style=color:#6e7681>
</span></span></span></code></pre></div><p>With the ability to tailor policies to our specific needs, we&rsquo;ll next explore each tool&rsquo;s capacity to integrate broadly, determining how well they play with the rest of our tech stack.</p><h2 id=integration-capabilities>Integration Capabilities<a hidden class=anchor aria-hidden=true href=#integration-capabilities>#</a></h2><p>Integration capabilities are the cornerstone of efficient DevOps practices.</p><p>This section will evaluate how each static code analyzer enhances your tech stack through seamless integration with other systems and technologies.</p><p>We will assess each tool against four key integration points that are vital for development workflows:</p><ul><li><strong>Docker Image</strong>: Ensures easy deployment across any container-supported environment.</li><li><strong>IDE Plugins</strong>: Facilitates real-time feedback and improves code quality directly within the developer&rsquo;s workspace.</li><li><strong>CI/CD Systems</strong>: Supports direct integration through plugins or extensions, eliminating the need for manual downloads or CLI setups.</li><li><strong>Pre-commit Hook</strong>: Provides an early security checkpoint by scanning code before it is committed, catching errors at the initial stages.</li></ul><table><thead><tr><th>Tool</th><th>Docker Image</th><th>IDE Plugins</th><th>CI/CD Systems</th><th>Hook</th></tr></thead><tbody><tr><td><strong>KICS</strong></td><td>‚úÖ</td><td>VSCode</td><td>Github Actions, GitLab, Terraform Cloud, Codefresh</td><td>‚úÖ</td></tr><tr><td><strong>tfsec</strong></td><td>‚úÖ</td><td>VSCode, JetBrains, Vim</td><td>Github Actions</td><td>‚ùå</td></tr><tr><td><strong>Trivy</strong></td><td>‚úÖ</td><td>VSCode, JetBrains, Vim</td><td>Azure DevOps, GitHub Actions, Buildkite, Dagger, Semaphore, CircleCI, Concourse CI</td><td>‚ùå</td></tr><tr><td><strong>Terrascan</strong></td><td>‚úÖ</td><td>VSCode</td><td>GitHub Actions, Atlantis</td><td>‚úÖ</td></tr><tr><td><strong>Checkov</strong></td><td>‚úÖ</td><td>VSCode, JetBrains</td><td>GitHub Actions, GitLab</td><td>‚úÖ</td></tr><tr><td><strong>Semgrep OSS</strong></td><td>‚úÖ</td><td>VSCode, JetBrains, Emacs, Vim</td><td>GitLab</td><td>‚úÖ</td></tr></tbody></table><p>In addition to the table above, here are a few noteworthy features of some tools:</p><ul><li>Checkov supports OpenAI integration to suggest remediations. But be careful because AI tends to hallucinate.</li><li>KICS supports applying auto-remediation for some of its out-of-the-box policies. This also applies to custom policies, where you can define remediations and apply them automatically.</li><li>Terrascan is the only one that provides the VSCode extension to create and test custom policies written in Rego.</li><li>GitLab uses KICS as its default built-in IaC scanner ‚Äî available out of the box with &ldquo;<a href=https://docs.gitlab.com/ee/user/application_security/iac_scanning/>Infrastructure as Code scanning</a>&rdquo;. However, there&rsquo;s also <a href=https://gitlab.com/guided-explorations/ci-cd-plugin-extensions/checkov-iac-sast>GitLab CI Component</a> available for Checkov.</li></ul><p>Having covered the integration capabilities, let‚Äôs now focus on the output formats each tool provides.</p><h2 id=output-formats-provided>Output Formats Provided<a hidden class=anchor aria-hidden=true href=#output-formats-provided>#</a></h2><p>Output formats extend the utility of static code analysis, facilitating integration with the CI/CD feedback loop and enabling its use as an artifact in subsequent CI jobs.</p><p>This chapter examines the variety of formats each tool supports for this purpose.</p><p>Each tool offers a range of output formats tailored to different needs.</p><p><strong>For GitLab users</strong>: For teams leveraging GitLab&rsquo;s security scanning, KICS, Checkov, and Semgrep OSS are equipped with compatible output formats, facilitating smooth GitLab integration.</p><p><strong>For GitHub users</strong>: SARIF&rsquo;s adoption as an industry standard, particularly by GitHub for code scanning, makes it a must-have. All tools assessed offer SARIF support, ensuring interoperability and broad utility.</p><p><strong>JUnit Reports</strong>: The availability of JUnit output is crucial for capturing test results in a format recognizable by various CI systems. Trivy, Terrascan, Checkov, and Semgrep OSS support this, enabling clear visualization of test outcomes and enhancing the feedback loop within CI pipelines.</p><p>Beyond these, each tool supports additional formats, enriching their application and versatility. Here&rsquo;s the full breakdown of the output formats, complementing the standard CLI output:</p><table><thead><tr><th>Tool</th><th>Supported Output Formats</th></tr></thead><tbody><tr><td><strong>KICS</strong></td><td>ASFF, CSV, Code Climate, CycloneDX, GItLab SAST, HTML, JSON, JUnit, PDF, SARIF, SonarQube</td></tr><tr><td><strong>tfsec</strong></td><td>Checkstyle, CSV, HTML, JSON, JUnit, Markdown, SARIF</td></tr><tr><td><strong>Trivy</strong></td><td>ASFF, Cosign, CycloneDX, JSON, SARIF, SPDX</td></tr><tr><td><strong>Terrascan</strong></td><td>JSON, JUnit, SARIF, XML, YAML</td></tr><tr><td><strong>Checkov</strong></td><td>CSV, CycloneDX, GItLab SAST, JSON, JUnit, SARIF, SPDX</td></tr><tr><td><strong>Semgrep OSS</strong></td><td>Emacs, GitLab SAST, JSON, JUnit, SARIF, Vim</td></tr></tbody></table><p>Moving from output formats to operational adaptability, let&rsquo;s investigate the customization options for scanner settings. This important feature allows each tool to align with varied project demands.</p><h2 id=customizing-scanner-settings>Customizing Scanner Settings<a hidden class=anchor aria-hidden=true href=#customizing-scanner-settings>#</a></h2><p>This chapter moves beyond the default scanner settings and delves into scanner settings&rsquo; customizability, ensuring that tools can be calibrated for any development environment or security requirement.</p><p>I will evaluate each tool against criteria that define a tool&rsquo;s adaptability and user-friendliness:</p><ul><li><strong>Targeted Scans</strong>: Select specific directories for scanning or exclusion to focus on pertinent areas and skip irrelevant ones.</li><li><strong>In-Code Ignore Policies</strong>: Enable ignore directives within code to skip checks when exceptions apply selectively.</li><li><strong>Severity Thresholds</strong>: Set reporting to include only findings above a chosen severity level, concentrating on the most impactful issues.</li><li><strong>Configuration File</strong>: Employ configuration files for consistency and collaboration, enabling a &lsquo;configuration as code&rsquo; approach.</li><li><strong>TF Variables Interpolation</strong>: Interpret and evaluate Terraform variables for an accurate security assessment of IaC.</li><li><strong>Module Scanning</strong>: For complete coverage, scans should include both local and remote (public/private) Terraform modules.</li></ul><p>Based on these criteria, the following table offers a comparative view of how each tool performs, giving you a clear snapshot of their customization capabilities:</p><table><thead><tr><th>Tool</th><th>Targeted Scans</th><th>Ignore Policies</th><th>Min Severity</th><th>Config File</th><th>Variables Interpolation</th><th>Module Scanning</th></tr></thead><tbody><tr><td><strong>KICS</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚ÅâÔ∏èÔ∏è</td></tr><tr><td><strong>tfsec</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td></tr><tr><td><strong>Trivy</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td></tr><tr><td><strong>Terrascan</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td></tr><tr><td><strong>Checkov</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td></tr><tr><td><strong>Semgrep OSS</strong></td><td>‚úÖ</td><td>‚úÖ</td><td>‚úÖ</td><td>‚ùå</td><td>‚úÖ</td><td>‚ùå</td></tr></tbody></table><p>Most reviewed tools meet nearly all the criteria set for scanner setting customization, demonstrating their flexibility and advanced capabilities. However, there are notable features worth considering:</p><ul><li>KICS: Provides limited module scanning capabilities, restricted to some public modules from the Terraform registry, and does not cover local or private custom modules.</li><li>Terrascan & Trivy: Both feature server modes that centralize vulnerability databases. This centralization facilitates a unified approach to applying policies and configurations, enhancing consistency and efficiency for teams and reducing the management overhead of diverse policies across multiple projects.</li><li>Semgrep: It doesn&rsquo;t support scanner configuration files; instead, it uses the &ldquo;config&rdquo; word to call the rule sets and accepts such configs. Notably, it also does not support the scanning of Terraform modules at all.</li></ul><h2 id=terraform-security-scanning-the-big-picture-and-top-pick>Terraform Security Scanning: The Big Picture and Top Pick<a hidden class=anchor aria-hidden=true href=#terraform-security-scanning-the-big-picture-and-top-pick>#</a></h2><p>Here&rsquo;s a comprehensive comparison summary to guide your selection of the most suitable Terraform static code analyzer:</p><table><thead><tr><th>Tool</th><th>Default Policies</th><th>Custom Policies</th><th>Integration</th><th>Output Formats</th><th>Customization</th></tr></thead><tbody><tr><td><strong>KICS</strong></td><td>663</td><td>OPA Rego</td><td>‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook</td><td>ASFF, CSV, Code Climate, CycloneDX, GItLab SAST, HTML, JSON, JUnit, PDF, SARIF, SonarQube</td><td>‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚ùåModule Scanning</td></tr><tr><td><strong>tfsec</strong></td><td>154</td><td>OPA Rego</td><td>‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚ùåGit Hook</td><td>Checkstyle, CSV, HTML, JSON, JUnit, Markdown, SARIF</td><td>‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning</td></tr><tr><td><strong>Trivy</strong></td><td>322</td><td>OPA Rego</td><td>‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚ùåGit Hook</td><td>ASFF, Cosign, CycloneDX, JSON, SARIF, SPDX</td><td>‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning</td></tr><tr><td><strong>Terrascan</strong></td><td>790</td><td>OPA Rego</td><td>‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook</td><td>JSON, JUnit, SARIF, XML, YAML</td><td>‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning</td></tr><tr><td><strong>Checkov</strong></td><td>2110</td><td>YAML, Python</td><td>‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook</td><td>CSV, CycloneDX, GItLab SAST, JSON, JUnit, SARIF, SPDX</td><td>‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚úÖConfig File, ‚úÖVariables Interpolation, ‚úÖModule Scanning</td></tr><tr><td><strong>Semgrep OSS</strong></td><td>362</td><td>YAML</td><td>‚úÖDocker, ‚úÖIDE, ‚úÖCI/CD, ‚úÖGit Hook</td><td>Emacs, GitLab SAST, JSON, JUnit, SARIF, Vim</td><td>‚úÖTargeted Scans, ‚úÖIgnore Policies, ‚úÖMin Severity, ‚ùåConfig File, ‚úÖVariables Interpolation, ‚ùåModule Scanning</td></tr></tbody></table><p>Integrating a Terraform security scanning into your development pipeline is a proven strategy to boost your security posture. These tools detect potential vulnerabilities early and enforce best practices and compliance standards, representing a proactive approach to infrastructure security.</p><p>For teams not yet utilizing these tools, <strong>Checkov</strong> is my top recommendation:</p><ul><li>Biggest number of default policies and supported Terraform providers for a quick start.</li><li>Custom policy support in YAML and Python for flexible policy creation.</li><li>Wide integration options with Docker, IDEs, CI/CD systems, and Git Hooks for a smooth workflow.</li></ul><p>Please share your favorite tool in the comments below! Also, let me know if I missed a cool product that should have been included in the review.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://devdosvid.blog/2024/06/03/unpacking-aws-outages-system-design-lessons-from-post-event-summaries/><span class=title>¬´ Prev</span><br><span>Unpacking AWS Outages: System Design Lessons from Post-Event Summaries</span>
</a><a class=next href=https://devdosvid.blog/2024/01/09/mastering-aws-api-gateway-v2-http-and-aws-lambda-with-terraform/><span class=title>Next ¬ª</span><br><span>Mastering AWS API Gateway V2 HTTP and AWS Lambda With Terraform</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=vasylenko/devdosvid.blog data-repo-id="MDEwOlJlcG9zaXRvcnkyNDUyNTMxODE=" data-category=General data-category-id=DIC_kwDODp5EPc4CA59c data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=en data-theme=light crossorigin=anonymous async></script></article></main><footer class=footer><div style=width:10em;margin:auto><p style=background-color:#0082ca;color:#fff>From Ukrainian</p><p style=background-color:#ffb548;color:#fff>with love ‚ù§Ô∏è</p></div><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>