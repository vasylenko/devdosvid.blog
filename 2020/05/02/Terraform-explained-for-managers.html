<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Terraform explained in English | Serhii Vasylenko</title><meta name=keywords content="terraform,tutorials"><meta name=description content="For those who want to understand the engineering team better and speak with it in the same language ‚Äî terraform explained."><meta name=author content="Serhii Vasylenko"><link rel=canonical href=https://serhii.vasylenko.info/2020/05/02/Terraform-explained-for-managers.html><link crossorigin=anonymous href=/assets/css/stylesheet.min.a89e0386ca160c2cca1b08ed0c9bfecbfcd97d3664be021c678a03a6a8fbb895.css integrity="sha256-qJ4DhsoWDCzKGwjtDJv+y/zZfTZkvgIcZ4oDpqj7uJU=" rel="preload stylesheet" as=style><link rel=preload href=/apple-touch-icon.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://serhii.vasylenko.info/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://serhii.vasylenko.info/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://serhii.vasylenko.info/favicon-32x32.png><link rel=apple-touch-icon href=https://serhii.vasylenko.info/apple-touch-icon.png><link rel=mask-icon href=https://serhii.vasylenko.info/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.89.2"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-GK7SE0XWGK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-GK7SE0XWGK',{anonymize_ip:!1})}</script><meta property="og:title" content="Terraform explained in English"><meta property="og:description" content="For those who want to understand the engineering team better and speak with it in the same language ‚Äî terraform explained."><meta property="og:type" content="article"><meta property="og:url" content="https://serhii.vasylenko.info/2020/05/02/Terraform-explained-for-managers.html"><meta property="og:image" content="https://serhii.vasylenko.info/cover-image.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-02T00:00:00+00:00"><meta property="article:modified_time" content="2020-05-02T00:00:00+00:00"><meta property="og:site_name" content="Serhii Vasylenko ‚Äî Personal Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://serhii.vasylenko.info/cover-image.png"><meta name=twitter:title content="Terraform explained in English"><meta name=twitter:description content="For those who want to understand the engineering team better and speak with it in the same language ‚Äî terraform explained."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://serhii.vasylenko.info/posts/"},{"@type":"ListItem","position":3,"name":"Terraform explained in English","item":"https://serhii.vasylenko.info/2020/05/02/Terraform-explained-for-managers.html"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Terraform explained in English","name":"Terraform explained in English","description":"For those who want to understand the engineering team better and speak with it in the same language ‚Äî terraform explained.","keywords":["terraform","tutorials"],"articleBody":"You might have heard about Terraform before, but if you have never tried it, this blog can help you to get the main point.\nA few words about ‚ÄúInfrastructure as Code\" First of all, Terraform is the way to manage the infrastructure in the form of code. The same way developers write the code to create applications, Terraform code can create the resources in virtual data centers (i.e., clouds).\nInfrastructure as Code, or IaC, is when you describe and manage your infrastructure as‚Ä¶ (guess what?) ‚Ä¶code, literally.\nIn a nutshell, that means you can define all the elements (servers, networks, storage, etc.) and resources (memory, CPU, etc.) of your infrastructure in configuration files, and manage it in a way similar to how you handle the source code of the applications: branches, releases, and all that stuff.\nAnd the main idea behind the IaC approach is that it manages the state of things and must remain the single source of truth (configuration truth) for your infrastructure.\nFirst, you define the state via the code. Then IaC tool (Terraform, for example) applies this state to the infrastructure: all that is missing according to the code will be created, all that differs from the code will be changed, and all that exists in the infrastructure but is not described via code ‚Äî will be destroyed.\nWhy and when do you need the Terraform for a project? Terraform is a specific tool, hence like any other tool, it has its particular application area. There is no strict definition of project kind that needs Terraform (surprise!), but in general, you need to consider using Terraform if you answer ‚Äòyes‚Äô to one of the following questions:\n Do you have multiple logical elements of the same kind (in plural) in your infrastructure, i.e., several web servers, several application servers, several database servers? Do you have numerous environments (or workspaces) where you run your applications, i.e., development, staging, QA, production? Do you spend a significant amount of time managing the changes in the environment(s) where you run your applications?  How does it work? Terraform works with the source code of configuration and interprets the code into real objects inside on-premise or cloud platforms.\n  How Terraform works in a nutshell\n  Terraform supports many platforms: cloud providers such as AWS, Azure, GCP, DigitalOcean, and other platforms such as OVH, 1\u00261, Hetzner, etc. It also supports infrastructure software such as Docker, Kubernetes, Chef, and even databases and monitoring software. That is why Terraform is so popular ‚Äî it is an actual Swiss knife in the operations world.\nSo to create, change, or destroy the infrastructure, Terraform needs the source code.\nThe source code is a set of configuration files that defines your infrastructure state. The code uses its syntax, but it looks very user-friendly. Here is an example: the following configuration block describes the virtual server (EC2 instance) in AWS.\nresource \"aws_instance\" \"web_server\" { ami = \"ami-a1b2c3d4\" instance_type = \"t3.micro\" } Terraform can automatically detect the dependencies between resources described in the code and also allows you to add custom dependencies when needed.\nWhen you apply the code the first time, Terraform creates a so-called ‚Äústate file,\" which Terraform uses to map your code to resources created in the hosting platform. Terraform will use each subsequent ‚Äúapply\" action to compare the code changes with the sate file to decide what should be done (and in what order) against real infrastructure.\nOne of the essential functions of the state file is the management of dependencies between the resources. For example (some technical nuances are omitted for simplicity): if you have a server created inside some network and you are going to change the network configuration in Terraform code, Terraform will know it should change that server configuration, or the server should be re-created inside the updated network.\nWhat does Terraform consist of: Terraform configuration code consists of several elements: providers, resources, modules, input variables, output values, local values, expressions, functions.\nProvider Provider is an entity that defines what exactly is possible to do with the cloud or on-premises infrastructure platform you manage via Terraform.\nIt translates your code into proper API calls to the hosting provider, transforming your configuration into real object: servers, networks, databases, and so on.\nResource Resource is the essential part of the configuration code. That is where the definition of infrastructure objects happens.\nResources are the main building blocks of the whole code. A resource can represent some object in the hosting provider (example: server) or the part of a compound object (example: attachable storage for a server)\nEvery resource has a type and local name. For example, here is how EC2 instance configuration may look like:\nresource \"aws_instance\" \"web_server\" { ami = \"ami-a1b2c3d4\" instance_type = \"t3.micro\" } The aws_instance is a resource type, and web_server is the local resource name. Later, when Terraform applies this code, it will create an EC2 instance with some particular ID in AWS.\nOnce created, Terraform will store the ID in the state file with mapping information that logically connects it with web_server.\nThe ami, instance_type, and private_ip are the arguments with values that define the actual state of the resource. However, there are many value types, depending on the particular argument and particular resource type, so I will not focus on them here.\nModules   Terraform module\n  Modules is the kind of logical containers or groups for resources you define and use together. The purpose of modules is the grouping of resources and the possibility of reusing the same code with different variables.\nLet‚Äôs get back to the example with the EC2 instance and say you need to have a static public IP address with it. In such a case, here is how the module for web server may look like:\nresource \"aws_instance\" \"web_server\" { ami = \"ami-a1b2c3d4\" instance_type = \"t3.micro\" } resource \"aws_eip\" \"web_server_public_ip\" { instance = \"${aws_instance.web_server.id}\" } Having these two resources together allows us to think of it as a stand-alone unit you can reuse later, for example, in our development, staging, and production environments. And not by copying and pasting it, but via reference to the module defined only once.\nPlease note: we specified an instance argument inside the aws_eip resource to reference another resource details (the ID of an instance). It is possible because of the way how Terraform treats dependencies. For example, when it detects the dependency (or you define it explicitly), Terraform creates the leading resource first. Only after the resource is created and available Terraform will create the dependent one.\nThe modules is a kind of standalone topic in Terraform. There is a separate article in my blog that explains what modules are and how do they work.\nVariables Input variables work as parameters for the modules so module code could be reusable. Let‚Äôs look at the previous example: it has some hardcoded values ‚Äî instance image ID and instance type. Here is how you can make it more abstract and reusable:\nvariable \"image_id\" { type = string } variable \"instance_type\" { type = string } resource \"aws_instance\" \"web_server\" { ami = var.image_id instance_type = var.instance_type } Values for the variables then can be passed either via CLI and environment variables (if you have only the one, so-called root module) or via explicit values in the block where you call a module, for example:\nmodule \"web_server_production\" { source = \"./modules/web_server\" image_id = \"ami-a1b2c3d4\" instance_type = \"m5.large\" } module \"web_server_development\" { source = \"./modules/web_server\" image_id = \"ami-a2b3c4d5\" instance_type = \"t3.micro\" } Output values are similar to the ‚Äúreturn‚Äù of a function in development language. You can use them for dependencies management (for example, when a module requires something from another module) and print specific values at the end of Terraform work (for example, to be used for notification in the CI/CD process).\nLocal values, expressions, functions ‚Äî three more things that augment the capabilities of Terraform and make it more similar to a programming language (which is excellent, by the way).\nThe local values are used inside modules for extended data manipulations.\nThe expressions are used to set the values (for many things), such as the value of some argument in resource configuration. For example, they used either to refer something (just as we referenced instance ID \"${aws_instance.web_server.id}\" in the example above) or to compute the value within your configuration.\nThe functions in Terraform are built-in jobs you can call to transform and combine values. For example, the tolist() function converts its argument to a list value.\nAnd this is it?   Yes, in short words ‚Äî this is what Terraform is. Not rocket science if it‚Äôs about to manage a small infrastructure, but it gets more complicated with bigger infrastructure. Like any other engineering tool, though.\nOkay, what next? If you read down to this point, then it means it is worth ‚Äúget your hands dirty‚Äù and to try building your Infrastructure with Terraform. There are plenty of courses and books (and the ‚ÄúTerraform up and running‚Äù is one of the most popular). Still, my learning path started from the following: Official guide from Hashicorp ‚Äî comprehensive and free guide from Terraform developers. Just pick your favorite cloud (AWS, Azure, GCP) and go through the topics.\nAnother thing worth your attention is A Comprehensive Guide to Terraform.\nOnce you finish this guide, I suggest jumping into the more real-world things and describing the infrastructure of the most common project you work with.\nYour hands-on experience is the best way to learn Terraform!\n","wordCount":"1577","inLanguage":"en","image":"https://serhii.vasylenko.info/cover-image.png","datePublished":"2020-05-02T00:00:00Z","dateModified":"2020-05-02T00:00:00Z","author":{"@type":"Person","name":"Serhii Vasylenko"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://serhii.vasylenko.info/2020/05/02/Terraform-explained-for-managers.html"},"publisher":{"@type":"Person","name":"Serhii Vasylenko","logo":{"@type":"ImageObject","url":"https://serhii.vasylenko.info/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://serhii.vasylenko.info accesskey=h title="Home (Alt + H)"><img src=/apple-touch-icon.png alt=logo aria-label=logo height=" 30px">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://serhii.vasylenko.info/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://serhii.vasylenko.info/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://serhii.vasylenko.info/about/ title="About me"><span>About me</span></a></li><li><a href=https://serhii.vasylenko.info/cv/ title="My CV"><span>My CV</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://serhii.vasylenko.info>Home</a>&nbsp;¬ª&nbsp;<a href=https://serhii.vasylenko.info/posts/>Posts</a></div><h1 class=post-title>Terraform explained in English</h1><div class=post-description>For those who want to understand the engineering team better and speak with it in the same language ‚Äî terraform explained.</div><div class=post-meta><span title="2020-05-02 00:00:00 +0000 UTC">May 2, 2020</span>&nbsp;¬∑&nbsp;Serhii Vasylenko&nbsp;|&nbsp;<a href=mailto:email-from-blog@vasylenko.info rel="noopener noreferrer" target=_blank>üì© Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy srcset="https://serhii.vasylenko.info/2020/05/02/cover-image_hu5827250bacf9fc4add138ddb4dfd9c93_41725_360x0_resize_box_3.png 360w ,https://serhii.vasylenko.info/2020/05/02/cover-image_hu5827250bacf9fc4add138ddb4dfd9c93_41725_480x0_resize_box_3.png 480w ,https://serhii.vasylenko.info/2020/05/02/cover-image_hu5827250bacf9fc4add138ddb4dfd9c93_41725_720x0_resize_box_3.png 720w ,https://serhii.vasylenko.info/2020/05/02/cover-image_hu5827250bacf9fc4add138ddb4dfd9c93_41725_1080x0_resize_box_3.png 1080w ,https://serhii.vasylenko.info/2020/05/02/cover-image_hu5827250bacf9fc4add138ddb4dfd9c93_41725_1500x0_resize_box_3.png 1500w ,https://serhii.vasylenko.info/2020/05/02/cover-image.png 2400w" sizes="(min-width: 768px) 720px, 100vw" src=https://serhii.vasylenko.info/2020/05/02/cover-image.png alt width=2400 height=1200></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#a-few-words-about-infrastructure-as-code aria-label="A few words about ‚ÄúInfrastructure as Code&amp;quot;">A few words about ‚ÄúInfrastructure as Code"</a></li><li><a href=#why-and-when-do-you-need-the-terraform-for-a-project aria-label="Why and when do you need the Terraform for a project?">Why and when do you need the Terraform for a project?</a></li><li><a href=#how-does-it-work aria-label="How does it work?">How does it work?</a></li><li><a href=#what-does-terraform-consist-of aria-label="What does Terraform consist of:">What does Terraform consist of:</a><ul><li><a href=#provider aria-label=Provider>Provider</a></li><li><a href=#resource aria-label=Resource>Resource</a></li><li><a href=#modules aria-label=Modules>Modules</a></li><li><a href=#variables aria-label=Variables>Variables</a></li></ul></li><li><a href=#and-this-is-it aria-label="And this is it?">And this is it?</a></li><li><a href=#okay-what-next aria-label="Okay, what next?">Okay, what next?</a></li></ul></div></details></div><div class=post-content><p>You might have heard about Terraform before, but if you have never tried it, this blog can help you to get the main point.</p><h2 id=a-few-words-about-infrastructure-as-code>A few words about ‚ÄúInfrastructure as Code"<a hidden class=anchor aria-hidden=true href=#a-few-words-about-infrastructure-as-code>#</a></h2><p>First of all, Terraform is the way to manage the infrastructure in the form of code. The same way developers write the code to create applications, Terraform code can create the resources in virtual data centers (i.e., clouds).</p><p>Infrastructure as Code, or IaC, is when you describe and manage your infrastructure as‚Ä¶ (guess what?) ‚Ä¶code, literally.</p><p>In a nutshell, that means you can define all the elements (servers, networks, storage, etc.) and resources (memory, CPU, etc.) of your infrastructure in configuration files, and manage it in a way similar to how you handle the source code of the applications: branches, releases, and all that stuff.</p><p>And the main idea behind the IaC approach is that it manages the state of things and must remain the single source of truth (configuration truth) for your infrastructure.</p><p>First, you define the state via the code. Then IaC tool (Terraform, for example) applies this state to the infrastructure: all that is missing according to the code will be created, all that differs from the code will be changed, and all that exists in the infrastructure but is not described via code ‚Äî will be destroyed.</p><h2 id=why-and-when-do-you-need-the-terraform-for-a-project>Why and when do you need the Terraform for a project?<a hidden class=anchor aria-hidden=true href=#why-and-when-do-you-need-the-terraform-for-a-project>#</a></h2><p>Terraform is a specific tool, hence like any other tool, it has its particular application area. There is no strict definition of project kind that needs Terraform (surprise!), but in general, you need to consider using Terraform if you answer ‚Äòyes‚Äô to one of the following questions:</p><ul><li>Do you have multiple logical elements of the same kind (in plural) in your infrastructure, i.e., several web servers, several application servers, several database servers?</li><li>Do you have numerous environments (or workspaces) where you run your applications, i.e., development, staging, QA, production?</li><li>Do you spend a significant amount of time managing the changes in the environment(s) where you run your applications?</li></ul><h2 id=how-does-it-work>How does it work?<a hidden class=anchor aria-hidden=true href=#how-does-it-work>#</a></h2><p>Terraform works with the source code of configuration and interprets the code into real objects inside on-premise or cloud platforms.</p><figure><img loading=lazy src=how-it-works-optimized.png alt="How Terraform works" width=800><figcaption><p>How Terraform works in a nutshell</p></figcaption></figure><p>Terraform supports many platforms: cloud providers such as AWS, Azure, GCP, DigitalOcean, and other platforms such as OVH, 1&1, Hetzner, etc. It also supports infrastructure software such as Docker, Kubernetes, Chef, and even databases and monitoring software. That is why Terraform is so popular ‚Äî it is an actual Swiss knife in the operations world.</p><p>So to create, change, or destroy the infrastructure, Terraform needs the source code.</p><p>The <strong>source code</strong> is a set of configuration files that defines your infrastructure state. The code uses its syntax, but it looks very user-friendly. Here is an example: the following configuration block describes the virtual server (EC2 instance) in AWS.</p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#6ab825;font-weight:700>resource</span> <span style=color:#ed9d13>&#34;aws_instance&#34; &#34;web_server&#34;</span> {
  ami           = <span style=color:#ed9d13>&#34;ami-a1b2c3d4&#34;</span>
  instance_type = <span style=color:#ed9d13>&#34;t3.micro&#34;</span>
  }
</code></pre></div><p>Terraform can automatically detect the dependencies between resources described in the code and also allows you to add custom dependencies when needed.</p><p>When you apply the code the first time, Terraform creates a so-called ‚Äú<strong>state file</strong>," which Terraform uses to map your code to resources created in the hosting platform. Terraform will use each subsequent ‚Äúapply" action to compare the code changes with the sate file to decide what should be done (and in what order) against real infrastructure.</p><p>One of the essential functions of the state file is the management of dependencies between the resources. For example (some technical nuances are omitted for simplicity): if you have a server created inside some network and you are going to change the network configuration in Terraform code, Terraform will know it should change that server configuration, or the server should be re-created inside the updated network.</p><h2 id=what-does-terraform-consist-of>What does Terraform consist of:<a hidden class=anchor aria-hidden=true href=#what-does-terraform-consist-of>#</a></h2><p>Terraform configuration code consists of several elements: providers, resources, modules, input variables, output values, local values, expressions, functions.</p><h3 id=provider>Provider<a hidden class=anchor aria-hidden=true href=#provider>#</a></h3><p><strong>Provider</strong> is an entity that defines what exactly is possible to do with the cloud or on-premises infrastructure platform you manage via Terraform.</p><p>It translates your code into proper API calls to the hosting provider, transforming your configuration into real object: servers, networks, databases, and so on.</p><h3 id=resource>Resource<a hidden class=anchor aria-hidden=true href=#resource>#</a></h3><p><strong>Resource</strong> is the essential part of the configuration code. That is where the definition of infrastructure objects happens.</p><p>Resources are the main building blocks of the whole code. A resource can represent some object in the hosting provider (example: server) or the part of a compound object (example: attachable storage for a server)</p><p>Every resource has a type and local name. For example, here is how EC2 instance configuration may look like:</p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#6ab825;font-weight:700>resource</span> <span style=color:#ed9d13>&#34;aws_instance&#34; &#34;web_server&#34;</span> {
  ami           = <span style=color:#ed9d13>&#34;ami-a1b2c3d4&#34;</span>
  instance_type = <span style=color:#ed9d13>&#34;t3.micro&#34;</span>
  }
</code></pre></div><p>The <code>aws_instance</code> is a resource type, and <code>web_server</code> is the local resource name. Later, when Terraform applies this code, it will create an EC2 instance with some particular ID in AWS.</p><p>Once created, Terraform will store the ID in the state file with mapping information that logically connects it with <code>web_server</code>.</p><p>The <code>ami</code>, <code>instance_type</code>, and <code>private_ip</code> are the arguments with values that define the actual state of the resource. However, there are many value types, depending on the particular argument and particular resource type, so I will not focus on them here.</p><h3 id=modules>Modules<a hidden class=anchor aria-hidden=true href=#modules>#</a></h3><figure><img loading=lazy src=module-example.png alt="Terraform module" width=800><figcaption><p>Terraform module</p></figcaption></figure><p><strong>Modules</strong> is the kind of logical containers or groups for resources you define and use together. The purpose of modules is the grouping of resources and the possibility of reusing the same code with different variables.</p><p>Let‚Äôs get back to the example with the EC2 instance and say you need to have a static public IP address with it. In such a case, here is how the module for web server may look like:</p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#6ab825;font-weight:700>resource</span> <span style=color:#ed9d13>&#34;aws_instance&#34; &#34;web_server&#34;</span> {
  ami           = <span style=color:#ed9d13>&#34;ami-a1b2c3d4&#34;</span>
  instance_type = <span style=color:#ed9d13>&#34;t3.micro&#34;</span>
  }
<span style=color:#6ab825;font-weight:700>resource</span> <span style=color:#ed9d13>&#34;aws_eip&#34; &#34;web_server_public_ip&#34;</span> {
  instance      = <span style=color:#ed9d13>&#34;${aws_instance.web_server.id}&#34;</span>
  }
</code></pre></div><p>Having these two resources together allows us to think of it as a stand-alone unit you can reuse later, for example, in our development, staging, and production environments. And not by copying and pasting it, but via reference to the module defined only once.</p><p>Please note: we specified an instance argument inside the <code>aws_eip</code> resource to reference another resource details (the ID of an instance). It is possible because of the way how Terraform treats dependencies. For example, when it detects the dependency (or you define it explicitly), Terraform creates the leading resource first. Only after the resource is created and available Terraform will create the dependent one.</p><p>The modules is a kind of standalone topic in Terraform. There is <a href=https://serhii.vasylenko.info/2020/09/09/terraform-modules-explained.html>a separate article in my blog</a> that explains what modules are and how do they work.</p><h3 id=variables>Variables<a hidden class=anchor aria-hidden=true href=#variables>#</a></h3><p><strong>Input variables</strong> work as parameters for the modules so module code could be reusable. Let‚Äôs look at the previous example: it has some hardcoded values ‚Äî instance image ID and instance type. Here is how you can make it more abstract and reusable:</p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#6ab825;font-weight:700>variable</span> <span style=color:#ed9d13>&#34;image_id&#34;</span> {
  type          = <span style=color:#6ab825;font-weight:700>string</span>
  }
<span style=color:#6ab825;font-weight:700>variable</span> <span style=color:#ed9d13>&#34;instance_type&#34;</span> {
  type          = <span style=color:#6ab825;font-weight:700>string</span>
  }
<span style=color:#6ab825;font-weight:700>resource</span> <span style=color:#ed9d13>&#34;aws_instance&#34; &#34;web_server&#34;</span> {
  ami           = <span style=color:#6ab825;font-weight:700>var</span>.<span style=color:#6ab825;font-weight:700>image_id</span>
  instance_type = <span style=color:#6ab825;font-weight:700>var</span>.<span style=color:#6ab825;font-weight:700>instance_type</span>
  }
</code></pre></div><p>Values for the variables then can be passed either via CLI and environment variables (if you have only the one, so-called root module) or via explicit values in the block where you call a module, for example:</p><div class=highlight><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=color:#6ab825;font-weight:700>module</span> <span style=color:#ed9d13>&#34;web_server_production&#34;</span> {
  source        = <span style=color:#ed9d13>&#34;./modules/web_server&#34;</span>
  image_id      = <span style=color:#ed9d13>&#34;ami-a1b2c3d4&#34;</span>
  instance_type = <span style=color:#ed9d13>&#34;m5.large&#34;</span>
  }
<span style=color:#6ab825;font-weight:700>module</span> <span style=color:#ed9d13>&#34;web_server_development&#34;</span> {
  source        = <span style=color:#ed9d13>&#34;./modules/web_server&#34;</span>
  image_id      = <span style=color:#ed9d13>&#34;ami-a2b3c4d5&#34;</span>
  instance_type = <span style=color:#ed9d13>&#34;t3.micro&#34;</span>
 }
</code></pre></div><p><strong>Output values</strong> are similar to the &ldquo;return&rdquo; of a function in development language. You can use them for dependencies management (for example, when a module requires something from another module) and print specific values at the end of Terraform work (for example, to be used for notification in the CI/CD process).</p><p><strong>Local values</strong>, <strong>expressions</strong>, <strong>functions</strong> ‚Äî three more things that augment the capabilities of Terraform and make it more similar to a programming language (which is excellent, by the way).</p><p>The local values are used inside modules for extended data manipulations.</p><p>The expressions are used to set the values (for many things), such as the value of some argument in resource configuration. For example, they used either to refer something (just as we referenced instance ID <code>"${aws_instance.web_server.id}"</code> in the example above) or to compute the value within your configuration.</p><p>The functions in Terraform are built-in jobs you can call to transform and combine values. For example, the <code>tolist()</code> function converts its argument to a list value.</p><h2 id=and-this-is-it>And this is it?<a hidden class=anchor aria-hidden=true href=#and-this-is-it>#</a></h2><figure><img loading=lazy src=done%20or.png></figure><p>Yes, in short words ‚Äî this is what Terraform is. Not rocket science if it&rsquo;s about to manage a small infrastructure, but it gets more complicated with bigger infrastructure. Like any other engineering tool, though.</p><h2 id=okay-what-next>Okay, what next?<a hidden class=anchor aria-hidden=true href=#okay-what-next>#</a></h2><p>If you read down to this point, then it means it is worth &ldquo;get your hands dirty&rdquo; and to try building your Infrastructure with Terraform. There are plenty of courses and books (and the &ldquo;Terraform up and running&rdquo; is one of the most popular). Still, my learning path started from the following: <a href=https://learn.hashicorp.com/terraform>Official guide from Hashicorp</a> ‚Äî comprehensive and free guide from Terraform developers. Just pick your favorite cloud (AWS, Azure, GCP) and go through the topics.</p><p>Another thing worth your attention is <a href=https://blog.gruntwork.io/a-comprehensive-guide-to-terraform-b3d32832baca>A Comprehensive Guide to Terraform</a>.</p><p>Once you finish this guide, I suggest jumping into the more real-world things and describing the infrastructure of the most common project you work with.</p><p>Your hands-on experience is the best way to learn Terraform!</p></div><footer class=post-footer><p class=substack-widget-preface>Did you like the article and want to stay in touch? Subscribe to my monthly newsletter with updates:</p><iframe class=substack-widget src=https://devexp.substack.com/embed frameborder=0 scrolling=no></iframe><ul class=post-tags><li><a href=https://serhii.vasylenko.info/tags/terraform/>terraform</a></li><li><a href=https://serhii.vasylenko.info/tags/tutorials/>tutorials</a></li></ul><nav class=paginav><a class=prev href=https://serhii.vasylenko.info/2020/08/06/ansible-secrets-aws-ssm-sm.html><span class=title>¬´ Prev Page</span><br><span>Manage Ansible playbook secrets with AWS services</span></a>
<a class=next href=https://serhii.vasylenko.info/2020/03/18/github-actions-first-impression.html><span class=title>Next Page ¬ª</span><br><span>Github Actions - First impression</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://serhii.vasylenko.info>Serhii Vasylenko</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script async defer src=https://simpleanalytics.vasylenko.info/latest.js></script><noscript><img src=https://simpleanalytics.vasylenko.info/noscript.gif alt referrerpolicy=no-referrer-when-downgrade></noscript><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>